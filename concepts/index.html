



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="RPC & event system for Python 3">
      
      
        <link rel="canonical" href="http://lightbus.org/concepts/">
      
      
        <meta name="author" content="Adam Charnock">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../">
      <meta name="generator" content="mkdocs-0.17.3, mkdocs-material-2.7.1">
    
    
      
        <title>Concepts - Lightbus</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.78aab2dc.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.6079476c.css">
      
    
    
      <script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="pink" data-md-color-accent="indigo">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#service" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="http://lightbus.org" title="Lightbus" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Lightbus
              </span>
              <span class="md-header-nav__topic">
                Concepts
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/adamcharnock/lightbus/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </span>
    Lightbus
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/adamcharnock/lightbus/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../installation/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Concepts
      </label>
    
    <a href="./" title="Concepts" class="md-nav__link md-nav__link--active">
      Concepts
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#service" title="Service" class="md-nav__link">
    Service
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lightbus-processes" title="Lightbus processes" class="md-nav__link">
    Lightbus processes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#non-lightbus-processes" title="Non-Lightbus processes" class="md-nav__link">
    Non-Lightbus processes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bus" title="Bus" class="md-nav__link">
    Bus
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api" title="API" class="md-nav__link">
    API
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remote-procedure-calls-rpcs" title="Remote Procedure Calls (RPCs)" class="md-nav__link">
    Remote Procedure Calls (RPCs)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#events" title="Events" class="md-nav__link">
    Events
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#transports" title="Transports" class="md-nav__link">
    Transports
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../quick-start/" title="Quick start" class="md-nav__link">
      Quick start
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../worked-example/" title="Worked example" class="md-nav__link">
      Worked example
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../apis/" title="APIs" class="md-nav__link">
      APIs
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../rpcs/" title="Remote prcedure calls" class="md-nav__link">
      Remote prcedure calls
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../events/" title="Events" class="md-nav__link">
      Events
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../configuration/" title="Configuration" class="md-nav__link">
      Configuration
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../schema/" title="Schema" class="md-nav__link">
      Schema
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../transports/" title="Transports" class="md-nav__link">
      Transports
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../command-line-use/" title="Command line use" class="md-nav__link">
      Command line use
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../debugging/" title="Debugging" class="md-nav__link">
      Debugging
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../plugins/" title="Plugins" class="md-nav__link">
      Plugins
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../contributing/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#service" title="Service" class="md-nav__link">
    Service
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lightbus-processes" title="Lightbus processes" class="md-nav__link">
    Lightbus processes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#non-lightbus-processes" title="Non-Lightbus processes" class="md-nav__link">
    Non-Lightbus processes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bus" title="Bus" class="md-nav__link">
    Bus
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api" title="API" class="md-nav__link">
    API
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remote-procedure-calls-rpcs" title="Remote Procedure Calls (RPCs)" class="md-nav__link">
    Remote Procedure Calls (RPCs)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#events" title="Events" class="md-nav__link">
    Events
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#transports" title="Transports" class="md-nav__link">
    Transports
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/adamcharnock/lightbus/edit/master/docs/concepts.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>Concepts</h1>
                
                <p>Lightbus allows processes to communicate through a
central medium, and has out-of-the-box support for Redis.
This can be done using any combination of RPCs or events.</p>
<p>We'll describe these concepts and their relationships in
more detail below.</p>
<h2 id="service">Service<a class="headerlink" href="#service" title="Permanent link">&para;</a></h2>
<p>Throughout this documentation we use the term <em>service</em>
to refer to one or more processes handling a common task.
These processes operate as a tightly-coupled whole.</p>
<p>For example, your company may run a help desk
(e.g <code>support.company.com</code>) , an online store (<code>store.company.com</code>),
and an internal image resizing service.
This documentation considers each of these to be a 'service'.</p>
<p>The support and store services would likely have both a web process and a
Lightbus process each. The image resizing service would likely have a Lightbus
process only.</p>
<p>All processes in a service should generally share the same API class
definitions.</p>
<p>A simple lightbus deployment could look something like this:</p>
<p><img alt="A simple Lightbus deployment" src="../static/images/simple-processes.png" /></p>
<h2 id="lightbus-processes">Lightbus processes<a class="headerlink" href="#lightbus-processes" title="Permanent link">&para;</a></h2>
<p>A Lightbus process is started with the <code>lightbus run</code> command.
A Lightbus process typically waits for any bus activity
and responds accordingly.</p>
<p>Lightbus processes are therefore concerned with:</p>
<ul>
<li>Listening for events</li>
<li>Responding to remote procedure calls</li>
</ul>
<p>In handling either of these, the Lightbus process may fire
additional events or call other RPCs.</p>
<p>A service may have zero-or-more Lightbus processes. <strong>A service
will only need a Lightbus process if it wishes to listen
for events or provide any RPCs which can be called.</strong></p>
<h2 id="non-lightbus-processes">Non-Lightbus processes<a class="headerlink" href="#non-lightbus-processes" title="Permanent link">&para;</a></h2>
<p>A web server would be a typical example of a non-Lightbus process
(e.g. Flask or Django). These processes can still interact with the
bus, but will typically do so briefly as part of their other duties.</p>
<p>Non-Lightbus process are therefore concerned with:</p>
<ul>
<li>Firing events</li>
<li>Calling RPCs</li>
</ul>
<h2 id="bus">Bus<a class="headerlink" href="#bus" title="Permanent link">&para;</a></h2>
<p>In computing, a bus is a shared communication medium. A bus allows any
software/hardware connected to that medium to communicate, as long as
common rules are obeyed. In this sense a bus is very similar to a conversation
between a group of people.</p>
<p>In electronics the communication medium can be a simple
copper cable. In software the communication medium is itself defined
by software.</p>
<p><strong>Lightbus uses Redis as its communication medium</strong>, although support
for other mediums may be added in future.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The core of Lightbus mostly consists of a programming interface
and presentational nicities.
The connection with the communication medium is provided by
customisable transports (see below). Lightbus ships with transports for Redis,
but transports could be created for other mediums should you wish.</p>
</div>
<h2 id="api">API<a class="headerlink" href="#api" title="Permanent link">&para;</a></h2>
<p>When we refer to an <em>API</em>, we are referring to an <code>Api</code> class definition.
<strong>All functionlaity on the bus is defined using APIs.</strong></p>
<p>For example, consider an API for support cases in the help desk service
mentioned above:</p>
<div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">SupportCaseApi</span><span class="p">(</span><span class="n">Api</span><span class="p">):</span>
    <span class="n">case_created</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">parameters</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;sender&#39;</span><span class="p">,</span> <span class="s1">&#39;subject&#39;</span><span class="p">,</span> <span class="s1">&#39;body&#39;</span><span class="p">))</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;support.case&#39;</span>

    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">get_case_from_db</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="nb">id</span><span class="p">)</span>
</pre></div>

<p>This API defines an event, a procedure, and the name used to address the API
on the bus. The help desk service could define multiple additional APIs as needed.</p>
<h2 id="remote-procedure-calls-rpcs">Remote Procedure Calls (RPCs)<a class="headerlink" href="#remote-procedure-calls-rpcs" title="Permanent link">&para;</a></h2>
<p>A remote procedure call is where you call a procedure available on the bus. The authoritative
service executes the procedure and you receive the result. This is useful when:</p>
<ol>
<li>You require information from a service</li>
<li>You wish to wait until a remote procedure has completed an action</li>
</ol>
<p>RPCs do not currently feature a 'fire and forget' mode of operation.</p>
<p>You can perform an RPC as follows:</p>
<div class="codehilite"><pre><span></span><span class="n">support_case</span> <span class="o">=</span> <span class="n">bus</span><span class="o">.</span><span class="n">support</span><span class="o">.</span><span class="n">case</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
</pre></div>

<p><strong>RPCs provide at-most-once semantics.</strong></p>
<h2 id="events">Events<a class="headerlink" href="#events" title="Permanent link">&para;</a></h2>
<p>Firing an event will place the event onto the bus and return immediately. No information
is provided as to whether the event was processed, or indeed of it was received by any
other service at all. No return value is provided when firing an event.</p>
<p>This is useful when:</p>
<ol>
<li>You wish to allow non-authoritative services to receive information without needing to concern yourself
   with their implementation</li>
<li>You wish the authoritative service to perform a known task in the background</li>
</ol>
<p>The <a href="../quick-start/#events">quickstart</a> provides an example of the latter case.</p>
<p><strong>Events provide at-least-once semantics.</strong></p>
<h2 id="transports">Transports<a class="headerlink" href="#transports" title="Permanent link">&para;</a></h2>
<p>Transports provide the communications system for Lightbus. There are four types
of transport:</p>
<ul>
<li><strong>RPC transports</strong> – sends and consumes RPC calls</li>
<li><strong>Result transports</strong> – sends and receives RPC results</li>
<li><strong>Event transports</strong> – sends and consumes events</li>
<li><strong>Schema transports</strong> – stores and retrieves the <a href="../schema/">bus schema</a></li>
</ul>
<p>Lightbus ships with a Redis-backed implementation of each of these transports.</p>
<p>Lightbus can be configured to use custom transports either globally, or on a per-API level.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../installation/" title="Installation" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Installation
              </span>
            </div>
          </a>
        
        
          <a href="../quick-start/" title="Quick start" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Quick start
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.8eb9be28.js"></script>
      
      <script>app.initialize({version:"0.17.3",url:{base:".."}})</script>
      
    
    
      
        <script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","UA-103655163-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
      
    
  </body>
</html>